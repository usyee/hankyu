<html>
    <title>阪急　宅配便システム</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
        <script src="https://yubinbango.github.io/yubinbango/yubinbango.js" charset="UTF-8"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <body>
        <div class="container d-flex">
            <div class="row align-self-center w-100">
                <div class="col-6 mx-auto">
                    <div class="jumbotron">
                        <form class="h-adr">
                            <h2><label>阪急　宅配便システム</label></h2>
                            
                            <br><input type="reset">

                            <div class="form-group">
                                <span class="p-country-name" style="display:none;">Japan</span>
                                <br><h4><label for="postalCode1">〒</label></h4>
                                <input id="postalCode1" type="number" class="p-postal-code form-control" maxlength="3" placeholder="530">
                                <input type="number" class="p-postal-code form-control" maxlength="4" placeholder="8350"><br>

                                <br><h4><label for="postalCode1">상세주소</label></h4>
                                <input id="region" type="text" class="p-region form-control" placeholder="Region" style="background-color:white"  /><br>
                                <input id="locality" type="text" class="p-locality form-control" placeholder="Locality" style="background-color:white"  /><br>
                                <input type="text" class="p-street-address form-control" placeholder="Street Address" style="background-color:white"  /><br>
                                <input type="text" class="p-extended-address form-control" placeholder="Extended Address" style="background-color:white"  />
                            </div>
                            <div class="form-group">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name="expressCompany" type="radio" id="expressCompany1"" value="택배회사1">
                                    <label class="form-check-label" for="expressCompany1">택배회사1</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name="expressCompany" type="radio" id="expressCompany2" value="택배회사2">
                                    <label class="form-check-label" for="expressCompany2">택배회사2</label>
                                </div>
                            </div>
                            <hr class="my-4">
                            <h4><label>최종결과</label></h4>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" style="background-color:white">현재시간</span>
                                </div>
                                <input id="currentTime" type="text" class="form-control" style="background-color:white" readonly>
                            </div>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" style="background-color:white">서비스판정</span>
                                </div>
                                <input id="deliveryType" type="text" class="form-control" style="background-color:white" readonly>
                            </div>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" style="background-color:white">일수 판정</span>
                                </div>
                                <input id="deliveryDay" type="text" class="form-control" style="background-color:white" readonly>
                                <div class="input-group-prepend">
                                    <span class="input-group-text" style="background-color:white">지정가능일수</span>
                                  </div>
                                <input id="possibleDate" type="text" class="form-control" style="background-color:white" readonly>
                            </div>
                            <hr class="my-4">
                            <h4><label>최종금액</label></h4>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" style="background-color:white">세전 송료</span>
                                </div>
                                <input id="shippingPrice" type="text" class="form-control" style="background-color:white" readonly>
                                <div class="input-group-prepend">
                                    <span class="input-group-text" style="background-color:white">세전 추가송료</span>
                                  </div>
                                <input id="shippingAddPrice" type="text" class="form-control" style="background-color:white" readonly>
                            </div>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" style="background-color:white">세후 송료</span>
                                </div>
                                <input id="shippingPriceWithTax" type="text" class="form-control" style="background-color:white" readonly>
                                <div class="input-group-prepend">
                                    <span class="input-group-text" style="background-color:white">세후 추가송료</span>
                                  </div>
                                <input id="shippingAddPriceWithTax" type="text" class="form-control" style="background-color:white" readonly>
                            </div>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" style="background-color:white">최종금액</span>
                                </div>
                                <input id="totalShippingPrice" type="text" class="form-control" style="background-color:white" readonly>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script type="text/javascript">
        let serviceAddress = ['大阪府','兵庫県明石市','兵庫県明石市','兵庫県芦屋市','兵庫県尼崎市','兵庫県伊丹市','兵庫県小野市','兵庫県加古川市','兵庫県加古郡','兵庫県川西市','兵庫県川辺郡','兵庫県神戸市','兵庫県丹波篠山市','兵庫県三田市','兵庫県高砂市','兵庫県宝塚市','兵庫県西宮市','兵庫県三木市','兵庫県姫路市','京都府宇治市','京都府乙訓郡','京都府木津川市','京都府京都市','京都府京田辺市','京都府久世郡','京都府城陽市','京都府相楽郡精華町','京都府綴喜郡','京都府長岡京市','京都府向日市','京都府八幡市','奈良県生駒市','奈良県生駒郡','奈良県香芝市','奈良県橿原市','奈良県葛城市',
'和歌山県和歌山市','滋賀県守山市','滋賀県草津市','滋賀県大津市','奈良県大和高田市','奈良県大和郡山市','奈良県奈良市','奈良県天理市','奈良県磯城郡','奈良県桜井市','奈良県北葛城郡'];

        $('[name="expressCompany"]').click(function() {
            let region = $('#region').val();
            let locality = $('#locality').val();
            let expressConpany = null;

            if (region === '' && locality === '') {
                alert('주소를 먼저 입력하세요.');
                $('input[type="radio"]').prop('checked', false);
            } else {
                expressConpany = $('[name="expressCompany"]:checked').val();

                calculatePrice(region, locality, expressConpany);
            }
        });

        function calculatePrice(region, locality, expressConpany) {
            let address = region + locality;
            let price = (expressConpany === '택배회사1') ? 1000 : 2000;
            let deliveryType = (serviceAddress.includes(address)) ? "서비스 지역" : "권외 지역";
            let deliveryDay = null;
            for (let i = 0; i < serviceAddress.length; i++) {
                if (address.includes(serviceAddress[i])) {
                    deliveryType = "서비스지역";

                    break;
                } else {
                    deliveryType = "권외 지역";
                }
            }

            if (deliveryType === "서비스 지역") {
                deliveryDay = 1;
            } else {
                // 기본은 5일로 설정해둠.
                // 만약 지역별로 다를 경우 시간을 설정해두셈.
                deliveryDay = 5;
            }

            $('#deliveryType').val(deliveryType);
            $('#deliveryDay').val(deliveryDay + "일");

            //여부턴 너가 계산해서 값 추가하셈.
            let shippingPrice = price;
            let shippingAddPrice = 300;
            let shippingPriceWithTax = price + 130;
            let shippingAddPriceWithTax = 330;
            let totalShippingPrice = shippingPriceWithTax + shippingAddPriceWithTax;

            $('#shippingPrice').val(shippingPrice);
            $('#shippingAddPrice').val(shippingAddPrice);

            $('#shippingPriceWithTax').val(shippingPriceWithTax);
            $('#shippingAddPriceWithTax').val(shippingAddPriceWithTax);

            $('#totalShippingPrice').val(totalShippingPrice);
        }

        function currentTime() {
            let time = new Date();

            let calendar = time.getFullYear() + "/" + (time.getMonth()+1) + "/" + time.getDate()
            let currentHours = setZero(time.getHours());
            let currentMinute = setZero(time.getMinutes());
            let currentSecond = setZero(time.getSeconds());

            let meridiem = (currentHours >= 12) ? 'PM' : 'AM';
            currentHours = (meridiem === 'PM') ? setZero(currentHours) - 12 : currentHours;

            let resultTime = calendar + " " + currentHours + ":" + currentMinute + ":" + currentSecond + " " + meridiem;

            return resultTime;
        }

        function setZero(value) {
            let result = '';
            let valueToString = value.toString();

            if (valueToString.length < 2) {
                result += '0';
            }

            return result + valueToString;
        }
        
        setInterval(function() {
            $('#currentTime').val(currentTime());
        }, 1000);
    </script>
    
</html>
